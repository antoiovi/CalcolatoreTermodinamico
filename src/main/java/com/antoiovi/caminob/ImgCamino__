 



public class ImgCamino extends JPanel implements ActionListener {
	
OutputData outdata;
	
int piano=1;
int npiani=1;
int sp=5;// spessore parete
int inter=20;//interspazio tar condotto esteerno e inerno verticale
private int h_1=300;
private int h_0=10;
private int h_u=50;
private int L1=100;// larghezza canale esterno
private int L2=30;// larghezza canaale interno
private int d1=30;//diam int canale d a fumo 
private int c=150;// distanza orizzontale da tubo esterno a canale da fumo
private int f=100;// h da base canne a innesto tubo esterno f+d2 deve essere minore di h
private int g=30;// discesa canale da fumo
public  Generatore generatore;
public boolean pmax=true;
Condotto condotto;
Condotto canale;
Pressioni pressioni;
public void setCanale(Condotto canale) {
	this.canale = canale;
}
VelocitaFluido vf_co;
public Condotto getCondotto() {
	return condotto;
}
public void setCondotto(Condotto condotto) {
	this.condotto = condotto;
}
 
public int getPiano() {
return piano;
}
public void setPiano(int piano) {
this.piano = piano;
String.valueOf(piano);
String.valueOf(piano-1);
}
/**
 * DATI DA VISUALIZZARE
 */

static double Potenza=10.0;
private static double Rendimento=95.0;
private Caldaia caldaia;
private Timer timer;

private int speed=300;
private Color alarmcolor_pca=Color.black;
private boolean pari_animation;
private CaminoB_1 camino;
private Color alarmcolor_aria;
private Color alarmcolor_speed_can=Color.black;
private Color alarmcolor_speed_cond=Color.black;

private Font font;
private Font rotatedFont;
private FontMetrics fontmetrics;
	 
	 
	  
			 String STR_COM=String.format("Perdi comignolo %1.3f pa", camino.dp_com);
		 
		
		
		/***
		 * DATI CANALE
			Canale da fumo
			double Cf_Tu;
			double Cf_Tm;
			double Cf_Ti;
			double Cf_dp;
			double Cf_ps;
			double Cf_peff;
			double Cf_Wm;
		 */
			
			String STR_CAN_T=String.format("Tu= %1.1f  Tm= %1.1f  Ti= %1.1f", outdata.Cf_Tu,outdata.Cf_Tm,outdata.Cf_Ti);
			String STR_CAN_DP= String.format("d_P() %1.2f Ps()= %1.3f ",outdata.Cf_dp,outdata.Cf_ps);
			String STR_CAN_W= String.format("Velocita= %1.3f",outdata.Cf_Wm);
			String STR_CAN_PEFF= String.format("Peff base= %1.3f",outdata.Cf_peff);
			
			
		}
		
		 / Condotto 
double Co_M;
double Co_Tu;
double Co_Tm;
double Co_Ti;
double Co_dp;
double Co_ps;
double Co_peff;
double Co_Wm;
double Co_Nr;
double Co_Mv;
double Co_Ar;
double Co_Dh;
			 
			String STR_CON_TU=String.format("Tu %1.1f K",outdata.Co_Tu);
			String STR_CON_TM=String.format("Tm %1.1f K",outdata.Co_Tm);
			
			String STR_CON_TM=String.format("Tm %1.1f K",outdata.Co_Tm);
			
			
			String STR_CON_MASS=String.format("Portata %1.4f k/s",outdata.Co_M);
						
			
			String STR_CON_W=String.format("Velocita %1.2f m/s",outdata.Co_Wm);
			
			
			
			String STR_CON_Nre=String.format("N Reynold %1.3f K",outdata.Co_Nr);
			
			
			
			String STR_CON_Mv=String.format("Densita %1.3f kg/m3",outdata.Co_Mv);
			
			
			String STR_CON_TM=String.format("Ti %1.1f K",outdata.Co_Ti);
			
			
			
			String STR_COND_DIM=String.format("Area %1.3f [m2] Diam idraulico %1.2f [m]",outdata.Co_Ar,Co_Dh);
			
			
			
			
			
			g2d.drawString("Peff(0) "+String.format("%1.3f",camino.peff_cond), xx+5, yt);
			g2d.setColor(Color.black);
			yt-=20;
			g2d.drawString("d_P() "+String.format("%1.2f",camino.dp_con), xx+5, yt);
			yt-=20;
			g2d.drawString("Ps(1) "+String.format("%1.3f",camino.ps_cond), xx+5, yt);
			yt-=20;
			g2d.drawString("Densita aria) "+String.format("%1.3f",condotto.getMassvolumaria()), xx+5, yt);
			yt-=20;
			
		}
		
		 
		paintCaldaia(g2d,x3,y0,d1,piano);
		
		
	}
	void paintPresaaria(Graphics2D g2d,int x_base,int y_base,int piano){
		Color color=g2d.getBackground();
		g2d.setColor(Color.blue);
		g2d.drawRect(x_base, y_base, 20, 20);
		if(camino!=null){
			g2d.setColor(alarmcolor_aria);
		String s=String.format("Portata d'aria %1.4f kg/s",camino.maria);
		
		g2d.drawString(s, x_base+25, y_base);
		}
		
		
		g2d.setColor(color);
	}
	public void setVf_co(VelocitaFluido vf_co) {
		this.vf_co = vf_co;
	}
	/**
	 * 
	 * @param g2d
	 * @param x_base punto a sinistra tratto verticale canale da fumo
	 * @param y_base base caldaia
	 * @param l2 larghezza canale fumo
	 */
	public   void paintCaldaia( Graphics2D g2d,int x_base,int y_base,int l2,int piano){
		Font font=g2d.getFont();
		FontMetrics metrics = g2d.getFontMetrics(font);
		// get the height of a line of text in this
		// font and render context
		int h_char = metrics.getHeight();
		int h_c=40;
		int a=20;
		int l_c=a+l2+a;// larghezza caldaia
		 int x_l=x_base-a;//x left
		// int x_r=x_base+l2+a;
		 int x_r=x_l+l_c;
		 int y_t=y_base;//y top
		 int y_b=y_base-h_c;//y bottom
		 g2d.drawLine(x_base , y_t ,x_base-10 ,y_t-5);
		 g2d.drawLine(x_base+l2 , y_t ,x_base+l2+10 ,y_t-5);
		 g2d.drawLine(x_base-10 , y_t-5 ,x_base+l2+10 ,y_t-5);
		 
		 
		 y_t-=10;
		 y_b-=10;
		g2d.drawLine(x_l , y_t ,x_r ,y_t);//tratto sup orizzontale left right
		g2d.drawLine( x_l, y_t ,x_l ,y_b );// verticale sx top bottom
		g2d.drawLine( x_l, y_b ,x_r ,y_b );// orizzontale inf  left right
		g2d.drawLine(  x_r,y_b ,x_r ,y_t);// verticale dx bottom top
		//g2d.drawString("Caldaia "+piano, x_r+5, y_b+5);
		int y_tt=y_t;
		if(caldaia!=null) {
			if(pmax){
		String s=String.format("Potenza max %1.1f  Rendimento %3.0f ",caldaia.getPmax(),caldaia.getRend_Pmax()*100);
		g2d.drawString(s, x_r+5, y_tt);
		y_tt-=10;
		  s=String.format("CO2 %1.1f  Eccesso d'aria %3.1f ",caldaia.getCO2percentPmax() ,caldaia.getEccariaPmax());
		g2d.drawString(s ,x_r+5, y_tt );
		y_tt-=10;
		s=String.format("Portata fumi %1.3f [kg/s]  ",caldaia.getPortatfumiPmax() );
		g2d.drawString(s ,x_r+5, y_tt );
		 y_tt-=10;
		s=String.format("Temperatura fumi %1.0f [K] ", caldaia.getTempFumiPmax());
		g2d.drawString(s ,x_r+5, y_tt );
		 y_tt-=10;
	 /*	Fluido fumo=caldaia.getFumoPmax();
	 	s= "Composizione "+fumo.toString();
	 	g2d.drawString(s ,0, y_tt -20);*/
		
			}else{// Potenza minima
				String s=String.format("Potenza min %1.1f  Rendimento %3.0f ",caldaia.getPmin(),caldaia.getRend_Pmin()*100);
				g2d.drawString(s, x_r+5, y_tt);
				y_tt-=10;
				  s=String.format("CO2 %1.1f  Eccesso d'aria %3.1f ",caldaia.getCO2percentPmin() ,caldaia.getEccariaPmin());
				g2d.drawString(s ,x_r+5, y_tt );
				y_tt-=10;
				s=String.format("Portata fumi %1.3f [kg/s]  ",caldaia.getPortatfumiPmin() );
				g2d.drawString(s ,x_r+5, y_tt );
				 y_tt-=10;
				s=String.format("Temperatura fumi %1.0f [K] ", caldaia.getTempFumiPmin());
				g2d.drawString(s ,x_r+5, y_tt );
				 y_tt-=10;
			}
		
		}
		
		/**
		 * disegna fiammella
		 */
		int k=15;
		Color c=pari_animation?Color.red:Color.yellow;
		g2d.setColor(c);
		for(int x=0;x<10;x++){
				g2d.drawLine(  x_l+k,y_b+4 ,x_l+k ,y_b+10);
			k+=2;
		}
		k=15+1;
		Color c2=pari_animation?Color.YELLOW:Color.red;
		g2d.setColor(c2);
		for(int x=0;x<10;x++){
				g2d.drawLine(  x_l+k,y_b+4 ,x_l+k ,y_b+10);
			k+=2;
		}
		g2d.setColor(Color.black);
	}
	/**
	 * STAMPA TABELLA PRESSIONI
	 * @param g2d
	 * @param x_base
	 * @param y_base
	 */
	
	public   void paintTabelPressioni( Graphics2D g2d,int x_base,int y_base){
		  String title=String.format("TABELLA RIEPIOGO CALCOLO PRESSIONI     .");
	int width=fontmetrics.stringWidth(title);
		// line space
	//	int ls=fontmetrics.getDescent()+2*fontmetrics.getAscent();
	//	ls*=-1;
		int ls=20;
		int height=0;
		
		int yt=y_base;
		g2d.drawString(title, x_base, yt);//titolo
		yt-=ls;
		height+=ls;
		
		g2d.drawString(String.format("Perdite comignolo               %f [pa] ", camino.dp_com), x_base, yt);
		yt-=ls;
		height+=ls;
		/**Ã¨
		 * Condotto
		 */
		g2d.drawString(String.format("d_P() perdite carico condotto    %1.3f",camino.dp_con), x_base, yt);
		yt-=ls;
		height+=ls;
		g2d.drawString(String.format("Ps(1) pressione statica condotto %1.3f",camino.ps_cond), x_base, yt);
		yt-=ls;
		height+=ls;
		/**
		 * Canale
		 */
		g2d.drawString( String.format("d_P() perdite carico canale    %1.3f ",camino.dp_can ), x_base, yt);
		yt-=ls;
		height+=ls;
		g2d.drawString( String.format(" Ps() pressione statica canale %1.3f " , camino.ps_ca), x_base, yt);
		yt-=ls;
		height+=ls;
		g2d.drawString( String.format("Peff base canale               %1.3f",camino.peff_ca_base),  x_base, yt);
		height+=ls;
		yt-=ls;
		g2d.drawRect(x_base, yt, width,height);
		
	}
	 
	public void setPmax(boolean pmax) {
		this.pmax = pmax;
	}
	public boolean isPmax() {
		return pmax;
	}
	@Override
	public void actionPerformed(ActionEvent arg0) {
		pari_animation = (countanimation%2 ==0)?true:false;
	if(camino!=null){
		
	
		if(camino.peff_cond<0.5){
			alarmcolor=pari_animation?Color.red:Color.black;
		}else{
			alarmcolor=Color.black;}
			if(canale!=null){
				if(camino.peff_ca_base<0.5){
					alarmcolor_pca=pari_animation?Color.red:Color.black;
				}else{
					alarmcolor_pca=Color.black;}
			}
			if(camino.maria<=0){
				alarmcolor_aria=pari_animation?Color.white:Color.blue;
			}else{
				alarmcolor_aria=Color.blue;
			}
			
			 
				alarmcolor_speed_can=camino.isVel_can_ok()?Color.black:(pari_animation?Color.red:Color.black);
				alarmcolor_speed_cond=camino.isVel_con_ok()?Color.black:(pari_animation?Color.red:Color.black);
			 
	}
		countanimation++;
		countanimation=countanimation >100 ? 1 : countanimation;
	 repaint();
	}
	
	String 
	
	public void setOutputData(OutputData outputdat){
		this.outdata=outputdat;
			String s=String.format("Tu= %1.1f  Tm= %1.1f  Ti= %1.1f", outdata.Cf_Tu,outdata.Cf_Tm,outdata.Cf_Ti);
			g2d.drawString( String.format("d_P() %1.2f Ps()= %1.3f ",camino.dp_can, camino.ps_ca), x2, y_y);
			g2d.drawString( String.format("Velocita= %1.3f",canale.Wm()), x2, y_y);
			g2d.drawString( String.format("Peff base= %1.3f",camino.peff_ca_base), x2, y_y)		
			
			
			
			
		
		
	}
	
	
	public void setCamino(CaminoB_1 camino) {
		condotto=camino.condotto;
		canale=camino.canale;
		caldaia=camino.caldaia;
		this.camino=camino;
		// TODO Auto-generated method stub
		
	}
	
}
